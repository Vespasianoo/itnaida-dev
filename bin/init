#!/usr/bin/env php
<?php

function findProjectRoot(string $startDir): string
{
    $currentDir = $startDir;

    while (!file_exists($currentDir . '/composer.json')) {
        $parentDir = dirname($currentDir);

        if ($parentDir === $currentDir) {
            throw new Exception('Não foi possível localizar a raiz do projeto.');
        }

        $currentDir = $parentDir;
    }

    return $currentDir;
}

$rootPath = findProjectRoot(__DIR__);
$destination = $rootPath . '/itnaida.json';
$source = __DIR__ . '/itnaida';

if (file_exists($destination)) {
    echo "Arquivo 'itnaida.json' já existe. Nenhuma ação foi tomada." . PHP_EOL;
    exit(0);
}

copy($source, $destination);
echo "Arquivo 'itnaida.json' copiado com sucesso para a raiz do projeto." . PHP_EOL;
